"use strict";(self["webpackChunkstrapi_catalog_viewer"]=self["webpackChunkstrapi_catalog_viewer"]||[]).push([[405],{8405:function(a,t,e){e.r(t),e.d(t,{default:function(){return w}});var s=e(6768),l=e(4232);const o={class:"container mt-4"},r={key:0,class:"spinner-border",role:"status"},i={key:1,class:"alert alert-danger"},c={key:2,class:"catalog-grid"},n={class:"catalog-card-title"},d={class:"catalog-card-footer"},g={key:3};function u(a,t,e,u,p,m){const v=(0,s.g2)("catalog-filter-bar"),f=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",o,[t[6]||(t[6]=(0,s.Lk)("h1",null,"Catalogues",-1)),(0,s.bF)(v,{campaigns:p.campaigns,selectedCampaign:p.selectedCampaign,"onUpdate:selectedCampaign":t[0]||(t[0]=a=>p.selectedCampaign=a),selectedStatus:p.selectedStatus,"onUpdate:selectedStatus":t[1]||(t[1]=a=>p.selectedStatus=a),sortBy:p.sortBy,"onUpdate:sortBy":t[2]||(t[2]=a=>p.sortBy=a)},null,8,["campaigns","selectedCampaign","selectedStatus","sortBy"]),p.loading?((0,s.uX)(),(0,s.CE)("div",r,[...t[3]||(t[3]=[(0,s.Lk)("span",{class:"visually-hidden"},"Loading...",-1)])])):(0,s.Q3)("",!0),p.error?((0,s.uX)(),(0,s.CE)("div",i,(0,l.v_)(p.error),1)):(0,s.Q3)("",!0),p.catalogs.length?((0,s.uX)(),(0,s.CE)("div",c,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.catalogs,a=>((0,s.uX)(),(0,s.Wv)(f,{key:a.documentId,to:{name:"CatalogDetail",params:{id:a.documentId}},class:"catalog-card"},{default:(0,s.k6)(()=>[(0,s.Lk)("h5",n,(0,l.v_)(a.title),1),(0,s.Lk)("div",{class:"catalog-card-image",style:(0,l.Tr)({backgroundImage:"url("+m.getCoverImageUrl(a)+")"})},null,4),(0,s.Lk)("div",d,[(0,s.Lk)("span",null,(0,l.v_)(a.number_of_pages)+" pages",1),(0,s.Lk)("span",null,[t[4]||(t[4]=(0,s.Lk)("i",{class:"bi bi-calendar me-1"},null,-1)),(0,s.eW)((0,l.v_)(m.formatDate(a.publication_date)),1)])])]),_:2},1032,["to"]))),128))])):p.loading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",g,[...t[5]||(t[5]=[(0,s.Lk)("p",null,"No catalogs found.",-1)])]))])}e(8111),e(116),e(8237);var p=e(7919);const m={class:"filter-bar"},v={class:"filter-group-left"},f={class:"form-group"},h=["value"],C=["value"],k={class:"form-group"},y=["value"],S={class:"form-group"},_=["value"];function L(a,t,e,o,r,i){return(0,s.uX)(),(0,s.CE)("div",m,[(0,s.Lk)("div",v,[(0,s.Lk)("div",f,[t[4]||(t[4]=(0,s.Lk)("label",{for:"campaignFilter"},"Campagnes",-1)),(0,s.Lk)("select",{id:"campaignFilter",class:"form-control",value:e.selectedCampaign,onChange:t[0]||(t[0]=t=>a.$emit("update:selectedCampaign",t.target.value))},[t[3]||(t[3]=(0,s.Lk)("option",{value:""},"Toutes",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.campaigns,a=>((0,s.uX)(),(0,s.CE)("option",{key:a.id,value:a.id},(0,l.v_)(a.name),9,C))),128))],40,h)]),(0,s.Lk)("div",k,[t[6]||(t[6]=(0,s.Lk)("label",{for:"statusFilter"},"Catalogues",-1)),(0,s.Lk)("select",{id:"statusFilter",class:"form-control",value:e.selectedStatus,onChange:t[1]||(t[1]=t=>a.$emit("update:selectedStatus",t.target.value))},[...t[5]||(t[5]=[(0,s.Lk)("option",{value:""},"Tous",-1),(0,s.Lk)("option",{value:"published"},"Publiés",-1),(0,s.Lk)("option",{value:"pending"},"En cours",-1)])],40,y)])]),(0,s.Lk)("div",S,[t[8]||(t[8]=(0,s.Lk)("label",{for:"sortOptions"},"Trier",-1)),(0,s.Lk)("select",{id:"sortOptions",class:"form-control",value:e.sortBy,onChange:t[2]||(t[2]=t=>a.$emit("update:sortBy",t.target.value))},[...t[7]||(t[7]=[(0,s.Fv)('<option value="name-asc" data-v-04307caf>Nom A - Z</option><option value="name-desc" data-v-04307caf>Nom Z - A</option><option value="publication-date-desc" data-v-04307caf>Publication (décroissant)</option><option value="publication-date-asc" data-v-04307caf>Publication (croissant)</option><option value="creation-date-desc" data-v-04307caf>Création (décroissant)</option><option value="creation-date-asc" data-v-04307caf>Création (croissant)</option>',6)])],40,_)])])}var b={name:"CatalogFilterBar",props:{campaigns:{type:Array,required:!0},selectedCampaign:{type:String,required:!0},selectedStatus:{type:String,required:!0},sortBy:{type:String,required:!0}},emits:["update:selectedCampaign","update:selectedStatus","update:sortBy"]},B=e(1241);const I=(0,B.A)(b,[["render",L],["__scopeId","data-v-04307caf"]]);var F=I,E={name:"CatalogList",components:{CatalogFilterBar:F},data(){return{catalogs:[],campaigns:[],selectedCampaign:"",selectedStatus:"",sortBy:"publication-date-desc",loading:!0,error:null,strapiBaseUrl:"https://strapi.scarpellino.fr"}},watch:{selectedCampaign(a){localStorage.setItem("catalogSelectedCampaign",a),this.fetchCatalogs()},selectedStatus(a){localStorage.setItem("catalogSelectedStatus",a),this.fetchCatalogs()},sortBy(a){localStorage.setItem("catalogSortBy",a),this.fetchCatalogs()}},async created(){const a=localStorage.getItem("catalogSelectedCampaign");a&&(this.selectedCampaign=a);const t=localStorage.getItem("catalogSelectedStatus");t&&(this.selectedStatus=t);const e=localStorage.getItem("catalogSortBy");e&&(this.sortBy=e),await this.fetchCatalogs();try{const a=await p.A.getCampaigns();this.campaigns=a.data.data}catch(s){this.error="Failed to fetch campaigns.",console.error(s)}finally{this.loading=!1}},methods:{async fetchCatalogs(){this.loading=!0,this.error=null;try{const a=await p.A.getCatalogs(this.selectedCampaign,this.sortBy,this.selectedStatus);this.catalogs=a.data.data}catch(a){this.error="Failed to fetch catalogs.",console.error(a)}finally{this.loading=!1}},formatDate(a){if(!a)return"";const t={year:"numeric",month:"long",day:"numeric"};return new Date(a).toLocaleDateString("fr-FR",t)},getStrapiMediaUrl(a){return a?`${this.strapiBaseUrl}${a}`:""},getCoverImageUrl(a){if(!a.pages||!a.pages.length)return"";let t=a.pages.find(a=>1===a.page_number);return t||(t=a.pages.reduce((a,t)=>t.page_number<a.page_number?t:a,a.pages[0])),t&&t.active_image_version&&t.active_image_version.fichier_jpeg?this.getStrapiMediaUrl(t.active_image_version.fichier_jpeg.url):""}}};const X=(0,B.A)(E,[["render",u],["__scopeId","data-v-7a438b04"]]);var w=X}}]);
//# sourceMappingURL=405.8f539cb9.js.map